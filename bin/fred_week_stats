#!/usr/bin/perl
use strict;
use warnings;

my @skip = qw/Sun Mon Tue Wed Thu Fri Sat/;

my %acc = ();
my $size = 0;
my $lineno = 0;

my ($file) = @ARGV;
exit if (not $file or not -e $file);
open FH, "$file";
my $oldweek = -1;
while (my $line = <FH>) {
  chomp $line;
  my %hash = split " ", $line;
  my $week = $hash{Week};
  my $x;
  delete $hash{$_} for (@skip);
  # print "$_ $hash{$_} " for (sort keys %hash);
  # print "\n";
  if ($week ne $oldweek) {
    print_acc(%acc);
    %acc = %hash;
    $size = 1;
    $oldweek = $week;
  }
  else {
    $size++;
    for my $x (keys %hash) { 
      $acc{$x} += $hash{$x};
    }
  }
}
print_acc(%acc);
close FH;


sub print_acc {
  my %acc = @_;
  return if $oldweek eq -1;
  print "line $lineno ";
  for my $x (sort keys %acc) { 
    print "$x\_SUM $acc{$x} $x\_AVE ", $acc{$x}/$size, " "; 
  }
  print "\n";
  $lineno++;
}

  
